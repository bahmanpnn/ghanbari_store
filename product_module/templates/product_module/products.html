{% extends "base.html" %}
{% load static %}
{% load poll_extras %}


{% block header_references %}
    <link rel="stylesheet" href="{% static "product_module/css/product_custom.css" %}">
{% endblock header_references %}
{% block content %}

    <!-- rts navigation bar area start -->
    <div class="rts-navigation-area-breadcrumb">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="navigator-breadcrumb-wrapper">
                        <a href="{% url "home_module:home-page" %}">صفحه اصلی</a>
                        <i class="fa-regular fa-chevron-left"></i>
                        <a class="current">فروشگاه</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- rts navigation bar area end -->
    <div class="section-seperator">
        <div class="container">
            <hr class="section-seperator">
        </div>
    </div>

    <!-- shop[ grid sidebar wrapper -->
    <div class="shop-grid-sidebar-area rts-section-gap">
        <div class="container">
            <div class="row g-0">
                <div class="col-xl-12 col-lg-12">
                    <div class="filter-select-area">
                        <div class="nice-select-area-wrapper-and-button">
                            <div class="nice-select-wrapper-1">
                                <div class="single-select">
                                    <form method="get" action="" id='filter-form'>
                                        <div>
                                            {{filter_form}}
                                        </div>
                                        {% comment %} <div class="button-area">
                                            <button class="rts-btn">فیلتر کنید</button>
                                        </div> {% endcomment %}
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="tab-content" id="myTabContent">
                        <div class="product-area-wrapper-shopgrid-list mt--20 tab-pane fade show active" id="home-tab-pane" role="tabpanel" aria-labelledby="home-tab" tabindex="0">
                            <div class="row g-4">
                                {% for product in products %}
                                    <div class="col-lg-20 col-lg-4 col-md-6 col-sm-12 col-12">
                                        {% include "product_module/includes/product_item.html" with product=product %}
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                        <div class="product-area-wrapper-shopgrid-list with-list mt--20 tab-pane fade" id="profile-tab-pane" role="tabpanel" aria-labelledby="profile-tab" tabindex="0">
                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="single-shopping-card-one discount-offer">
                                        <a href="shop-details.html" class="thumbnail-preview">
                                            <div class="badge">
                                                <span>25% <br> 
                                                    تخفیف
                                                </span>
                                                <i class="fa-solid fa-bookmark"></i>
                                            </div>
                                            <img src="/static/assets/images/grocery/03.jpg" alt="خواربار">
                                        </a>
                                        <div class="body-content">
                                            <div class="title-area-right">
                                                <a href="shop-details.html">
                                                    <h4 class="title">میوه های مخلوط و گندم کاجیب سرلاک با شیر</h4>
                                                </a>
                                                <span class="availability">بسته 500 گرمی</span>
                                                <div class="price-area">
                                                    <span class="current">36.00 تومان</span>
                                                    <div class="previous">36.00 تومان</div>
                                                </div>
                                                <div class="cart-counter-action">
                                                    <div class="quantity-edit">
                                                        <input type="text" class="input" value="1">
                                                        <div class="button-wrapper-action">
                                                            <button class="button"><i class="fa-regular fa-chevron-down"></i></button>
                                                            <button class="button plus">+<i class="fa-regular fa-chevron-up"></i></button>
                                                        </div>
                                                    </div>
                                                    <a href="#" class="rts-btn btn-primary radious-sm with-icon">
                                                        <div class="btn-text">
                                                            افزودن به سبد خرید
                                                        </div>
                                                        <div class="arrow-icon">
                                                            <i class="fa-regular fa-cart-shopping"></i>
                                                        </div>
                                                        <div class="arrow-icon">
                                                            <i class="fa-regular fa-cart-shopping"></i>
                                                        </div>
                                                    </a>
                                                </div>
                                            </div>
                                            <div class="natural-value">
                                                <h6 class="title">
                                                    ارزش های تغذیه ای
                                                </h6>
                                                <div class="single">
                                                    <span>انرژی (کیلو کالری): </span>
                                                    <span>211</span>
                                                </div>
                                                <div class="single">
                                                    <span>پروتئین (g): </span>
                                                    <span>211</span>
                                                </div>
                                                <div class="single">
                                                    <span>مگنتیم (کیلو کالری): </span>
                                                    <span>211</span>
                                                </div>
                                                <div class="single">
                                                    <span>کالری (کیلو کالری): </span>
                                                    <span>211</span>
                                                </div>
                                                <div class="single">
                                                    <span>ویتامین (کیلو کالری): </span>
                                                    <span>211</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- shop[ grid sidebar wrapper end -->
    
    
    <!-- pagination -->

    <div class="pagination">
        <ul class="pagination post-pagination">
            {% if page_obj.has_previous %}
                <li>
                    <a class="prev btn rts-btn" href="?{% query_update request page=page_obj.previous_page_number %}">
                        قبلی
                    </a>
                </li>
            {% endif %}
    
            {% for page in paginator.page_range %}
                <li>
                    <a 
                        {% if page_obj.number == page %}
                            class="btn rts-btn active"
                        {% else %}
                            class="btn rts-btn"
                        {% endif %}
                        href="?{% query_update request page=page %}"
                    >
                        {{ page }}
                    </a>
                </li>
            {% endfor %}
    
            {% if page_obj.has_next %}
                <li>
                    <a class="next btn rts-btn" href="?{% query_update request page=page_obj.next_page_number %}">
                        بعدی
                    </a>
                </li>
            {% endif %}
        </ul>
    </div>
    
    <!-- end pagination -->

{% endblock content %}
{% block footer_references %}
    <script>
        function updateSorting() {
            const form = document.getElementById('filter-form');
            const sortSelect = document.getElementById('sort');
            const selectedSort = sortSelect.value;

            // Create a URLSearchParams object to manage query parameters
            const params = new URLSearchParams(new FormData(form));

            // Update the sort parameter
            params.set('product_filter', selectedSort);

            // Redirect to the updated URL
            window.location.search = params.toString();
        }
    </script>
{% endblock footer_references %}

